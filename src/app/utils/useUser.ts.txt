import { useEffect } from "react";
import Router from "next/router";
import useSWR from "swr";
import { Guest } from "@/interfaces";

export default function useUser({
  redirectTo = "",
  redirectIfFound = false,
} = {}) {
  const { data: user, mutate: mutateUser } = useSWR<Guest>("/api/user");

  useEffect(() => {
    // if no redirect needed, just return (example: already on /dashboard)
    // if user data not yet there (fetch in progress, logged in or not) then don't do anything yet
    if (!redirectTo || !user) return;

    if (
      // If redirectTo is set, redirect if the user was not found.
      (redirectTo && !redirectIfFound && !user?.isLoggedIn) ||
      // If redirectIfFound is also set, redirect if the user was found
      (redirectIfFound && user?.isLoggedIn)
    ) {
      Router.push(redirectTo);
    }
  }, [user, redirectIfFound, redirectTo]);

  return { user, mutateUser };
}

https://api.github.com/repos/OWNER/REPO/commits
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e/comments
https://api.github.com/repos/octocat/Hello-World/git/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/tree/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/OWNER/REPO/commits/COMMIT_SHA/branches-where-head
https://api.github.com/repos/octocat/Hello-World/commits/c5b97d5ae6c19d5c5df71a34c7fbeeda2479ccbc
https://api.github.com/repos/OWNER/REPO/commits/COMMIT_SHA/pulls
https://api.github.com/repos/octocat/Hello-World/pulls/1347
https://api.github.com/repos/octocat/Hello-World/issues/1347
https://api.github.com/repos/octocat/Hello-World/pulls/1347/commits
https://api.github.com/repos/octocat/Hello-World/pulls/1347/comments
https://api.github.com/repos/octocat/Hello-World/pulls/comments{/number}
https://api.github.com/repos/octocat/Hello-World/issues/1347/comments
https://api.github.com/repos/octocat/Hello-World/statuses/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/repos/octocat/Hello-World/labels/bug
https://api.github.com/repos/octocat/Hello-World/milestones/1
https://api.github.com/repos/octocat/Hello-World/milestones/1/labels
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/users/hubot
https://api.github.com/users/hubot/followers
https://api.github.com/users/hubot/following{/other_user}
https://api.github.com/users/hubot/gists{/gist_id}
https://api.github.com/users/hubot/starred{/owner}{/repo}
https://api.github.com/users/hubot/subscriptions
https://api.github.com/users/hubot/orgs
https://api.github.com/users/hubot/repos
https://api.github.com/users/hubot/events{/privacy}
https://api.github.com/users/hubot/received_events
https://api.github.com/users/other_user
https://api.github.com/users/other_user/followers
https://api.github.com/users/other_user/following{/other_user}
https://api.github.com/users/other_user/gists{/gist_id}
https://api.github.com/users/other_user/starred{/owner}{/repo}
https://api.github.com/users/other_user/subscriptions
https://api.github.com/users/other_user/orgs
https://api.github.com/users/other_user/repos
https://api.github.com/users/other_user/events{/privacy}
https://api.github.com/users/other_user/received_events
https://api.github.com/teams/1
https://api.github.com/teams/1/members{/member}
https://api.github.com/teams/1/repos
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/repos/octocat/Hello-World
https://api.github.com/repos/octocat/Hello-World/{archive_format}{/ref}
https://api.github.com/repos/octocat/Hello-World/assignees{/user}
https://api.github.com/repos/octocat/Hello-World/git/blobs{/sha}
https://api.github.com/repos/octocat/Hello-World/branches{/branch}
https://api.github.com/repos/octocat/Hello-World/collaborators{/collaborator}
https://api.github.com/repos/octocat/Hello-World/comments{/number}
https://api.github.com/repos/octocat/Hello-World/commits{/sha}
https://api.github.com/repos/octocat/Hello-World/compare/{base}...{head}
https://api.github.com/repos/octocat/Hello-World/contents/{+path}
https://api.github.com/repos/octocat/Hello-World/contributors
https://api.github.com/repos/octocat/Hello-World/deployments
https://api.github.com/repos/octocat/Hello-World/downloads
https://api.github.com/repos/octocat/Hello-World/events
https://api.github.com/repos/octocat/Hello-World/forks
https://api.github.com/repos/octocat/Hello-World/git/commits{/sha}
https://api.github.com/repos/octocat/Hello-World/git/refs{/sha}
https://api.github.com/repos/octocat/Hello-World/git/tags{/sha}
https://api.github.com/repos/octocat/Hello-World/issues/comments{/number}
https://api.github.com/repos/octocat/Hello-World/issues/events{/number}
https://api.github.com/repos/octocat/Hello-World/issues{/number}
https://api.github.com/repos/octocat/Hello-World/keys{/key_id}
https://api.github.com/repos/octocat/Hello-World/labels{/name}
https://api.github.com/repos/octocat/Hello-World/languages
https://api.github.com/repos/octocat/Hello-World/merges
https://api.github.com/repos/octocat/Hello-World/milestones{/number}
https://api.github.com/repos/octocat/Hello-World/notifications{?since,all,participating}
https://api.github.com/repos/octocat/Hello-World/pulls{/number}
https://api.github.com/repos/octocat/Hello-World/releases{/id}
https://api.github.com/repos/octocat/Hello-World/stargazers
https://api.github.com/repos/octocat/Hello-World/statuses/{sha}
https://api.github.com/repos/octocat/Hello-World/subscribers
https://api.github.com/repos/octocat/Hello-World/subscription
https://api.github.com/repos/octocat/Hello-World/tags
https://api.github.com/repos/octocat/Hello-World/teams
https://api.github.com/repos/octocat/Hello-World/git/trees{/sha}
https://api.github.com/repos/octocat/Hello-World/hooks
https://api.github.com/licenses/mit
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/repos/octocat/Hello-World
https://api.github.com/repos/octocat/Hello-World/{archive_format}{/ref}
https://api.github.com/repos/octocat/Hello-World/assignees{/user}
https://api.github.com/repos/octocat/Hello-World/git/blobs{/sha}
https://api.github.com/repos/octocat/Hello-World/branches{/branch}
https://api.github.com/repos/octocat/Hello-World/collaborators{/collaborator}
https://api.github.com/repos/octocat/Hello-World/comments{/number}
https://api.github.com/repos/octocat/Hello-World/commits{/sha}
https://api.github.com/repos/octocat/Hello-World/compare/{base}...{head}
https://api.github.com/repos/octocat/Hello-World/contents/{+path}
https://api.github.com/repos/octocat/Hello-World/contributors
https://api.github.com/repos/octocat/Hello-World/deployments
https://api.github.com/repos/octocat/Hello-World/downloads
https://api.github.com/repos/octocat/Hello-World/events
https://api.github.com/repos/octocat/Hello-World/forks
https://api.github.com/repos/octocat/Hello-World/git/commits{/sha}
https://api.github.com/repos/octocat/Hello-World/git/refs{/sha}
https://api.github.com/repos/octocat/Hello-World/git/tags{/sha}
https://api.github.com/repos/octocat/Hello-World/issues/comments{/number}
https://api.github.com/repos/octocat/Hello-World/issues/events{/number}
https://api.github.com/repos/octocat/Hello-World/issues{/number}
https://api.github.com/repos/octocat/Hello-World/keys{/key_id}
https://api.github.com/repos/octocat/Hello-World/labels{/name}
https://api.github.com/repos/octocat/Hello-World/languages
https://api.github.com/repos/octocat/Hello-World/merges
https://api.github.com/repos/octocat/Hello-World/milestones{/number}
https://api.github.com/repos/octocat/Hello-World/notifications{?since,all,participating}
https://api.github.com/repos/octocat/Hello-World/pulls{/number}
https://api.github.com/repos/octocat/Hello-World/releases{/id}
https://api.github.com/repos/octocat/Hello-World/stargazers
https://api.github.com/repos/octocat/Hello-World/statuses/{sha}
https://api.github.com/repos/octocat/Hello-World/subscribers
https://api.github.com/repos/octocat/Hello-World/subscription
https://api.github.com/repos/octocat/Hello-World/tags
https://api.github.com/repos/octocat/Hello-World/teams
https://api.github.com/repos/octocat/Hello-World/git/trees{/sha}
https://api.github.com/repos/octocat/Hello-World/hooks
https://api.github.com/licenses/mit
https://api.github.com/repos/octocat/Hello-World/pulls/1347
https://api.github.com/repos/octocat/Hello-World/issues/1347
https://api.github.com/repos/octocat/Hello-World/issues/1347/comments
https://api.github.com/repos/octocat/Hello-World/pulls/1347/comments
https://api.github.com/repos/octocat/Hello-World/pulls/comments{/number}
https://api.github.com/repos/octocat/Hello-World/pulls/1347/commits
https://api.github.com/repos/octocat/Hello-World/statuses/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/OWNER/REPO/commits/REF
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e/comments
https://api.github.com/repos/octocat/Hello-World/git/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/tree/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/OWNER/REPO/compare/BASEHEAD
https://api.github.com/repos/octocat/Hello-World/compare/master...topic
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e/comments
https://api.github.com/repos/octocat/Hello-World/git/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/tree/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e/comments
https://api.github.com/repos/octocat/Hello-World/git/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/tree/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e/comments
https://api.github.com/repos/octocat/Hello-World/git/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/tree/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/users/octocat
https://api.github.com/users/octocat/followers
https://api.github.com/users/octocat/following{/other_user}
https://api.github.com/users/octocat/gists{/gist_id}
https://api.github.com/users/octocat/starred{/owner}{/repo}
https://api.github.com/users/octocat/subscriptions
https://api.github.com/users/octocat/orgs
https://api.github.com/users/octocat/repos
https://api.github.com/users/octocat/events{/privacy}
https://api.github.com/users/octocat/received_events
https://api.github.com/repos/octocat/Hello-World/commits/6dcb09b5b57875f334f61aebed695e2e4193db5e
https://api.github.com/repos/octocat/Hello-World/contents/file1.txt?ref=6dcb09b5b57875f334f61aebed695e2e4193db5e

